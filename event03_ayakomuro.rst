===================================================================
次期リリースDebian 7.0 (コード名Wheezy)に搭載されるKernerlの変更点
===================================================================

はじめに
==========
次期リリースのDebian 7.0 、コード名Wheezyでは、カーネル開発者によって、安定カーネル規則に乗っ取って、バグ修正や、新しいハードウェアのサポート等が行なわれていますが、Debianでは、Linux 3.2が対応している機能以外にも追加で搭載しています。

kernel.orgでLInux3.2系のメンテナーでもありDebianカーネルチームのBen Hutchingsさんのブログに紹介されていたので、抄訳＋αでご紹介します。


Unionファイルシステム
=========================
Debian Liveでは、読み込み専用のライブシステムイメージにファイルを書き込む必要があり、それを解決するのがUnion ファイルシステムです。これを実現する為に、Junjiro R. Okajima氏によって開発されたaufsを取り込みました。

LinuxではUnionFSを取り込む事は決まっているが、次期が決まっていないそうです。

参考リンク
- http://unionfs.filesystems.org/ 
- http://ja.wikipedia.org/wiki/UnionFS 
- http://aufs.sourceforge.net/ 

セキュリティ強化
=======================
Magic SysRq機能がディフォルトで制限されるようになりました。
変更するには/etc/sysctl.confでkernel.sysrqにて変更が可能です。
※Magic SysRqとは、Linuxカーネルにおいてシステムの状態がどのような状態であれ低レベルコマンドを発行するキーシーケンスであり、SysRqと他のキーと組み合わせて使用されます。基本的にはカーネルのデバック用や、システムフリーズ時にファイルシステムを破壊する事無くコンピューター再起動させる為に使用されます。

参考リンク
- http://en.wikipedia.org/wiki/Magic_SysRq_key 

ネットワークプロトコル、AF_IEEE802154、AF_RDS、AF_DECnetは明示的に読み込まなければいけなくなりました。ソケットを作成するだけでは呼び込まれません。


debugfsのルートはディフォルトで700になりました。これはLinux3.7でも取り込まれる事が決まっている機能です）


Linux3.6からカーネルレベルで制限されるsymlinkとハードリンクが入り、ディフォルトで有効になります。
こちらも/etc/sysctl.confで fs.protected_symlinks と fs.protected_hardlinksから変更する事が出来ます。
参考リンク
- https://lwn.net/Articles/472071/ 

プロセスファイルシステム(procfs)の、hidepid/hidegid機能が搭載されますが、ディフォルトでは有効になっていません。
これが有効になると、ユーザーがお互いのプロセス状況をprcfsから見る事が出来、セキュリティ問題になりうるかもしれません。

Bufferbloat
=================

以下の二点がBackportから取り込まれました。

Byte Queue LImits(BQL) によって、ネットワークドライバーがハードウェアのファイル転送キューの不要なバッファーを軽減する事が出来ます。。Linux3.3でのbnx2, bnx2x, e1000e, forcedeth, igb, ixgbe, sfc, skge, tg3のドライバーに取り込まれています。
Benさん曰く多分必要じゃないと思うけど、という事らしい。

CoDelキュー管理アルゴリズムは、ソフトウェアのファイル転送キューの不要なバッファーを軽減する事が出来ます。FQ CoDelは、複数ネットワークフロー間での公平性の機能を追加しています。これらはLinux3.5ではcodelとfq_codelとして搭載されています。
tc コマンドを使う事で選択する事が出来ます。

..code-block:: shell
   tc qdisc replace dev eth0 root fq_codel



CPUディバイス
====================

sysdevsを除いていは、一般的なディバイスとして、CPUはディバイスモデルなどは公開されています。
x86 CPUではモデルや機能情報はueventに書き出されています。ディバイスサポートが行なわれるようになった為、initスクリプトに書かずに、自動で適切なディバイスのドライバーが読み込まれる様になりました。

* CPUのスケーリングドライバー
* intel_idle ドライバー
* CPU 温度監視ドライバー
* ストリーミングSIMD拡張や、もしくはVIA Padlockなどのセキュリティに特化したドライバー


コントロールグループ
========================

ほとんどのコントロールグウループ(cgroups)機能は搭載されましたが、いくつかはディフォルトで起動時に無効になっている物がありあす。

* メモリー管理は無効になっており、カーネルパラメーターの cgroup_enable=memoryにて有効にする事が出来ます。
* 自動グルーピングのスケジューラーが無効になっており、sysctlのkernel.sched_autogroup_enabledで有効にする事が出来ます。

EFI スタブ
=======================

x86のアーキテクチャのカーネルでは、EFIが実行可能になるようにビルドしており、EFIシェルから直接呼び込めるようになっています。

..code-block:: shell
 Shell> vmlinuz-3.2.0-4-amd64 root=/dev/sda2 initrd=initrd.img-3.2.0-4-amd64

Debianでは通常EFIシステム上でgrub-efi経由でブートします。これは、特殊な設定や、開発中のEFIブートローダー等を検証する時には便利な方法でしょう。


LInuxセキュリティモジュール(LSM)
==================================

AppArmorユーザーランド2.4-2.7は、Wheezyのユーザーランドと同じになります。
Debianは、AppArmors, SELinux, TOMOYOからLSMを選べる唯一のディストリビューションのようです。ブートパラメーターに security=で指定する事で、有効にする事が出来ます。



Xen用にCPU マイクロコードのアップデート
===========================================
他のハードウェアにあるように、CPUはバグがあった場合、マイクロコードで直せる事があります。x86マイクロコードの更新はBIOSか、OS経由で適応する事が出来ますが、BIOSをアップデートするよりはパッケージをアップデートする方が簡単です。
Xen4.1ではdom0カーネルに依頼する形で、マイクロコードの変更を反映させる事が出来ます。


リアルタイムスケジューリング
================================

linux-rtと呼ばれているPREEMPT_RT パッチセットでは、Linux配下で、リアルタイムスケジュール機能を提供します。これを使う事で、アプリケーションに対して低いI/Oレイテンシーとジッタをもたらします。もちろん結果はアプリケーションデザインとハードウェアとそのファームウェアにかかってきます。

リアルタイムスケジューリングは通常は産業管理(?)で使われており、ライブ音声やビデオのアプリケーション、高い波があるトレイディングシステムなどで使われます。ペア状況のクラスターコンピューティングなどでも有効です。




Hyper-V ゲストドライバー
===============================

他のVMハイパーバイザーの様に、Microsoft Hyper-Vは準仮想化ドライバーをサポートし、古いハードウェアのドライバーをエミュレートするよりもよいパフォーマンスを提供する事が出来ます。Linux 3.2ではこれらの初期のバージョンのドライバーをステージングエリアに追いやり、より最新のバージョンにアップデートしました。

Hyber-Vゲストの管理サポートとして提供される事をBenさんは望んでいるそうなのですが、fixさせるところがあるので、まだその時ではないそうです。



参考資料
==============================
- http://www.debian-news.net/2013/01/27/debian-project-news-january-21st-2013/ 
- http://womble.decadent.org.uk/blog/whats-in-the-linux-kernel-for-debian-70-wheezy-part-1.html 
- http://womble.decadent.org.uk/blog/whats-in-the-linux-kernel-for-debian-70-wheezy-part-2.html 
- http://womble.decadent.org.uk/blog/whats-in-the-linux-kernel-for-debian-70-wheezy-part-3.html 




































参考URL
- http://en.wikipedia.org/wiki/Bufferbloat 






